<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="./formStyle.css" />
    <title>Form Handling</title>
  </head>
  <script>
    let Name = document.getElementById("username");
    let Password = document.getElementById("Password");
    let date = document.getElementById("dob");
    let cPassword = document.getElementById("confirmPassword");
    let validEmail = new RegExp("^[a-zA-Z0-9]+@[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$");
    let validPassword = new RegExp("^[a-zA-Z0-9@*#$%]{5,10}");
    let validName = new RegExp("^[a-zA-Z0-9]{2,10}$");

    function checkName() {
      let Name = document.getElementById("username");
      if (!validName.test(Name.value)) {
        Name.classList.add("is-invalid");
        Name.classList.remove("is-valid");
      } else Name.classList.remove("is-invalid");
      Name.classList.add("is-valid");
    }
    function checkEmail() {
      let email = document.getElementById("email");
      if (!validEmail.test(email.value)) {
        email.classList.add("is-invalid");
        email.classList.remove("is-valid");
      } else {
        email.classList.remove("is-invalid");
        email.classList.add("is-valid");
      }
    }
    function checkPassword() {
      let password = document.getElementById("Password");
      if (!validPassword.test(password.value)) {
        password.classList.add("is-invalid");
        password.classList.remove("is-valid");
      } else {
        password.classList.remove("is-invalid");
        password.classList.add("is-valid");
      }
    }
    function checkConfirmPassword() {
      let password = document.getElementById("Password");
      let cpassword = document.getElementById("confirmPassword");
      if (cpassword.value != password.value) {
        cpassword.classList.add("is-invalid");
        cpassword.classList.remove("is-valid");
      } else {
        cpassword.classList.remove("is-invalid");
        cpassword.classList.add("is-valid");
      }
    }

    function checkDate() {
      let date = document.getElementById("dob");
      let dob = new Date(date.value);
      let currentDate = new Date();
      let currentYear = currentDate.getFullYear();
      let dobYear = dob.getFullYear();
      //console.log(dobYear);
      let yearDiff = currentYear - dobYear;
      //console.log(yearDiff);
      if (yearDiff <= 18) {
        console.log("invalid date");

        date.classList.add("is-invalid");
        date.classList.remove("is-valid");
      } else {
        console.log("valid date");
        date.classList.add("is-valid");
        date.classList.remove("is-invalid");
      }
    }

    function validateForm() {
      if (!validName.test(Name.value)) {
        alert(
          "UserName can have onle aplha numeric character and only 3 spaces"
        );
      }

      let validEmail = new RegExp("^[a-zA-Z0-9]+@[a-zA-Z0-9]+\.{2,3}");
      if (!validEmail.test(email.value)) {
        alert("Invalid Email");
      }
      let dob = new Date(date.value);
      let currentDate = new Date();
      dobYear = dob.getFullYear();
      if (currentDate.getFullYear - dobYear >= 18) {
        alert("Invalid Date");
      }
      let validPassword = "^[a-zA-Z0-9@*#$%]{5-10}";
      if (Password.value != validPassword) {
        alert("Invalid Password");
      }
      if (cPassword.value != Password.value) {
        alert("Confirm Password is not same as your password");
      }
    }
  </script>
  <body style="padding: 200px">
    <center><h3>Form Handling</h3></center>
    <form id="userForm">
      <div class="form-group">
        <label for="UserName">Username</label>
        <input
          type="name"
          class="form-control"
          id="username"
          placeholder="Enter your Username"
          oninput="checkName()"
        />
        <div class="form-group">
          <label for="Email1">Email address</label>
          <input
            type="email"
            class="form-control"
            id="email"
            placeholder="Enter your email"
            oninput="checkEmail()"
          />
        </div>
        <small id="emailHelp" class="form-text text-muted"
          >We'll never share your email with anyone else.</small
        >
      </div>
      <div class="form-group">
        <label for="exampleInputPassword1">Password</label>
        <input
          type="password"
          class="form-control"
          id="Password"
          placeholder="Password"
          oninput="checkPassword()"
        />
      </div>
      <div class="form-group">
        <label for="confirmPassword">Confirm Password</label>
        <input
          type="password"
          class="form-control"
          id="confirmPassword"
          placeholder=" Enter your password again"
          oninput="checkConfirmPassword()"
        />
      </div>
      <div class="form-group">
        <label for="dob">Enter your Date of Birth</label>
        <input
          type="date"
          value="2023-03-21"
          class="form-control"
          id="dob"
          oninput="checkDate()"
          max="2005-01-01"
        />
        <small id="emailHelp" class="form-text text-muted"
          >Your age should be greater than 18 years</small
        >
      </div>

      <center>
        <button type="button" class="btn btn-primary" onclick="validateForm()">
          Submit
        </button>
      </center>
    </form>
  </body>
</html>
